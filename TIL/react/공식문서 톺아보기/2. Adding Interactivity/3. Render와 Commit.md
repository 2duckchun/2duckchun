# render와 commit
- 컴포넌트가 스크린에 display되기 전에, 리액트에 의해 반드시 render와 commit 과정을 거친다.
- render와 commit의 대략적인 프로세스를 이해한다면 내 코드가 리액트에서 어떻게 실행되는지 이해할 수 있을 것이다.

## render와 commit 단계를 주방(kitchen)으로 비교
- `컴포넌트`를 주방으로, `웨이터`을 리액트로, `손님`을 사용자 요청으로 생각해보자.
- render와 commit 단계는 총 3가지로 구분할수 있다.
1. `렌더 유발(Triggering)` : 웨이터가 손님의 오더를 주방으로 전달할 때.
2. `컴포넌트 렌더링` : 주방에서 음식을 준비.
3. `DOM에 커밋(반영, Commit)` : 웨이터가 손님의 테이블에 음식을 가져다 놓음

---

## Step1. 렌더 유발
- 2가지 렌더링 조건으로 인해 컴포넌트가 렌더되기 시작한다.
1. 컴포넌트의 `초기 렌더링`시 컴포넌트 렌더링이 유발됨
2. 컴포넌트의 `state 변경`시 컴포넌트 렌더링이 유발됨

### 초기 렌더링(Initial render) 
```js
import Component from './Component.js';
import { createRoot } from 'react-dom/client';

const root = createRoot(document.getElementById('root'))
root.render(<Component />); // 초기 렌더링
```
- 앱이 처음 시작될 때, 모든 컴포넌트는 새롭게 렌더링되어야 할 것이다.
- 즉, 초기 렌더링에서는 createRoot('렌더링될엘리먼트').render(<컴포넌트 />)가 동작하여 모든 것을 렌더링한다. (최상단 컴포넌트부터 DOM에 그려진다.)

### 리렌더링(Re-renders when state updates)
- 초기 렌더링이 끝난 이후, setState에 의해 state가 업데이트되며 렌더링을 다시 요구하게 될 수 있다.
- 이 경우, (component의 state가 변경될 경우) 렌더링이 `큐`(자료구조, 대기열)에 추가된다. (렌더링이 유발된다.)
- `state 업데이트` -> `렌더링 유발` - > `렌더`

## Step2. 컴포넌트 렌더링
- 렌더가 유발되고 난 후, 리액트는 컴포넌트를 호출하여 화면에 표시할 내용을 찾는다.
- 즉, `렌더링`은 리액트가 컴포넌트를 `호출`하는 것이라고 할 수 있다.
  - 초기 렌더링시에는 리액트는 최상단(root) 컴포넌트를 `렌더링(호출)`한다.
  - 초기 렌더링 다음에 유발된 렌더링에서는 state가 변경된 컴포넌트를 `렌더링`한다.
- 리액트의 컴포넌트 `렌더링`은 재귀적이므로, 더이상 중첩된 컴포넌트가 없을때까지 모든 컴포넌트를 `렌더링`한다.
- `렌더링`이 끝나면 변경된 state나 props에 대한 컴포넌트의 정보를 가지고 있게 된다.
- 새로운 state와 props에 대한 컴포넌트의 정보는 **commit 단계**에서 쓰이게 된다.

### Deep Dive : 성능 최적화
```
컴포넌트 렌더링이 재귀적으로 이루어지므로, 컴포넌트의 중첩도가 큰 상태에서 상위 컴포넌트의 state가 변경될 경우, 렌더링이 매우 많이 이뤄질 수 있다.
따라서 앱의 컴포넌트 중첩도가 복잡해질수록 성능을 최적화 해야한다.
이 점에 대해서는 추후에 다룰 예정이다. 다만 앱을 너무 초기에 최적화하려고 하지는 마라.
```

## Step3. DOM에 반영(Commit)
- `렌더링`이 끝난 후 리액트에 의해 DOM에 반영된다.
- 초기 렌더링에는 리액트는 `appendChild()` DOM API를 통해 컴포넌트를 화면에 반영한다.
- 리렌더링될때는 리액트는 최소한의 부분만 교체하고 싶어한다. 따라서 이전에 렌더링된 정보와 현재 렌더링된 정보를 비교한다.
  - 두 렌더링 정보를 비교하며, **바뀐 부분만 DOM 노드에 적용**시킨다.

## Epil. 브라우저 렌더링과 리액트 렌더링의 차이
- 컴포넌트의 산출물(리액트 렌더링)이 DOM에 Commit되면 브라우저는 이것을 화면에 그리게 된다(브라우저 렌더링).
- 브라우저 렌더링과 리액트의 렌더링은 다른 개념임을 숙지해두자.
- **리액트 렌더링** : 컴포넌트를 호출해서 정보를 계산하는 행위.
- **브라우저 렌더링** : DOM을 브라우저 화면에 그리는 행위.

--- 

## Recap
- [ ] 리액트 앱의 화면 변화에는 아래 3가지 스텝이 있다.
  1. Trigger (state 변경 등으로 인한 렌더링 유발)
  2. Render (컴포넌트 호출 후 정보 취득)
  3. Commit (렌더링 결과를 비교하여 변경된 부분만 DOM에 반영)
- [ ] 리액트는 렌더링 결과가 지난번과 같으면 DOM을 변경하지 않는다.